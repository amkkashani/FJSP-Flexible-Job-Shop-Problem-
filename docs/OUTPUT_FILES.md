# Output Files Documentation

This document describes all output files generated by the FJSP Solver.

---

## Output Folder Structure

When you run `main.py`, outputs are generated in:

```
output/
└── {input_filename}_{timestamp}/
    ├── sheets/
    │   ├── sheet_00000.png
    │   ├── sheet_00001.png
    │   └── ...
    ├── sheet_parts.csv
    ├── sheet_summary.csv
    ├── product_summary.csv
    ├── schedule.csv
    └── solution_summary.txt
```

### Folder Naming

The output folder name is constructed as:
```
{data_file_stem}_{YYYYMMDD}_{HHMMSS}
```

**Example:** `5693_cleaned_20251224_115349`

---

## CSV Files

### sheet_parts.csv

Detailed mapping of every part to its assigned sheet.

#### Columns

| Column | Type | Description |
|--------|------|-------------|
| Sheet ID | string | Sheet identifier (e.g., "sheet_00001") |
| Part ID | string | Part identifier (e.g., "row_00001") |
| ElemIdent | string | Original element identifier from input |
| Product ID | string | Product this part belongs to |
| Material | string | Material code |
| Area (m2) | float | Part area in square meters |
| Length (mm) | float | Part length in millimeters |
| Width (mm) | float | Part width in millimeters |

#### Example

```csv
Sheet ID,Part ID,ElemIdent,Product ID,Material,Area (m2),Length (mm),Width (mm)
sheet_00000,row_00001,E001,PROD_001,MAT_A,0.500000,1000.0,500.0
sheet_00000,row_00002,E002,PROD_001,MAT_A,0.320000,800.0,400.0
sheet_00001,row_00003,E003,PROD_002,MAT_B,0.720000,1200.0,600.0
```

#### Use Cases

- Track which parts are on which sheets
- Verify part assignments
- Quality control and traceability
- Input for downstream systems

---

### sheet_summary.csv

Summary statistics for each sheet.

#### Columns

| Column | Type | Description |
|--------|------|-------------|
| Sheet ID | string | Sheet identifier |
| Num Parts | int | Number of parts in this sheet |
| Num Products | int | Number of distinct products |
| Used Area (m2) | float | Total area used |
| Capacity (m2) | float | Sheet capacity |
| Waste (m2) | float | Unused area |
| Utilization (%) | float | Usage percentage |
| Products | string | Semicolon-separated list of product IDs |

#### Example

```csv
Sheet ID,Num Parts,Num Products,Used Area (m2),Capacity (m2),Waste (m2),Utilization (%),Products
sheet_00000,4,3,3.599900,3.600000,0.000100,99.99,AB11893-01; AB14133-02; ABK16058-01
sheet_00001,4,4,3.599600,3.600000,0.000400,99.99,AB11893-01; AB14133-01; AB2765-05; AS12017-01
```

#### Use Cases

- Analyze sheet utilization
- Identify high-waste sheets
- Optimize packing strategies
- Production planning

---

### product_summary.csv

Summary of each product's parts and completion time.

#### Columns

| Column | Type | Description |
|--------|------|-------------|
| Product ID | string | Product identifier |
| Num Parts | int | Total parts in this product |
| Num Sheets | int | How many sheets contain this product's parts |
| Completion Time | float | When all parts of this product finish |
| Sheet IDs | string | Semicolon-separated list of sheets |

#### Example

```csv
Product ID,Num Parts,Num Sheets,Completion Time,Sheet IDs
AB11893-01,8,5,9331.00,sheet_00000; sheet_00001; sheet_00002; sheet_00024; sheet_00067
AB11893-02,8,5,12457.00,sheet_00002; sheet_00003; sheet_00022; sheet_00048; sheet_00070
PROD_001,12,3,8640.00,sheet_00000; sheet_00005; sheet_00012
```

#### Use Cases

- Track product completion times
- Identify products spread across many sheets
- Analyze product flow through production
- Delivery time estimation

---

### schedule.csv

Detailed station scheduling for each sheet.

#### Columns

| Column | Type | Description |
|--------|------|-------------|
| Sheet ID | string | Sheet identifier |
| Station | string | Station name (wa, wf, wd, wo, wg, wv, wx) |
| Machine | int | Machine index (0-based) |
| Start Time | float | When processing starts |
| End Time | float | When processing ends |
| Duration | float | Processing duration |

#### Example

```csv
Sheet ID,Station,Machine,Start Time,End Time,Duration
sheet_00000,wa,0,0.00,64.00,64.00
sheet_00000,wf,0,64.00,116.00,52.00
sheet_00000,wo,0,116.00,156.00,40.00
sheet_00000,wg,0,156.00,184.00,28.00
sheet_00000,wx,0,184.00,200.00,16.00
sheet_00001,wa,1,0.00,48.00,48.00
```

#### Use Cases

- Gantt chart generation
- Machine utilization analysis
- Bottleneck identification
- Production scheduling integration

---

## Text Files

### solution_summary.txt

Human-readable summary of the complete solution.

#### Contents

```
============================================================
FJSP SOLUTION SUMMARY
============================================================

Input file: data/5693_cleaned.xlsx
Generated: 2024-12-24 11:53:49

----------------------------------------
PROBLEM STATISTICS
----------------------------------------
Total parts: 1300
Total products: 77
Total parts area: 278.0595 m2
Sheet capacity: 3.6 m2
Unique materials: 25

----------------------------------------
SOLUTION STATISTICS
----------------------------------------
Sheets used: 78
Total waste: 2.7405 m2
Total used area: 278.0595 m2
Average utilization: 99.02%
Makespan: 18821.00 time units
Avg product completion: 7762.35 time units
Solution valid: True

----------------------------------------
OUTPUT FILES
----------------------------------------
- sheet_parts.csv: Detailed part assignments
- sheet_summary.csv: Sheet statistics
- product_summary.csv: Product statistics
- schedule.csv: Station scheduling
- sheets/: Individual sheet images
```

#### Use Cases

- Quick overview of solution quality
- Documentation for reports
- Comparison between runs

---

## Image Files

### sheets/*.png

Visual representation of each sheet showing part placement.

#### Image Contents

Each sheet image shows:

1. **Sheet Boundary**: Gray rectangle representing the sheet
2. **Parts**: Colored rectangles representing parts
   - Color coded by product
   - Labels show part ID; "(R)" indicates a rotated part
3. **Title**: Sheet statistics
   - Sheet ID
   - Number of parts
   - Number of products
   - Used area
   - Utilization percentage
4. **Legend**: Product colors and part IDs

#### Image Properties

- **Format**: PNG
- **Resolution**: 150 DPI
- **Size**: ~12x9 inches (varies with legend)

#### Example Filename

```
sheet_00000.png
sheet_00001.png
...
sheet_00077.png
```

#### Current Limitations

The visualization uses a shelf-based 2D placement with rotation. It shows actual part positions inside the sheet, but the placement is heuristic and may not be globally optimal.

#### Use Cases

- Visual inspection of packing
- Quality control documentation
- Customer communication
- Production floor guidance

---

## Interpreting the Output

### Key Metrics

| Metric | Good Value | Description |
|--------|------------|-------------|
| Utilization | > 95% | Higher is better (less waste) |
| Waste | Low | Total unused area across all sheets |
| Makespan | Low | Time to complete all processing |
| Fitness | Low | Combined objective (waste + time) |

### Common Patterns

#### High Utilization (Good)
```
Sheets used: 78
Total waste: 2.74 m2
Utilization: 99.02%
```
Parts are well-packed with minimal waste.

#### Many Sheets with Low Utilization
```
Sheets used: 120
Utilization: 65%
```
Consider:
- Reviewing sorting strategy
- Checking for parts larger than capacity
- Adjusting sheet capacity

#### Long Makespan
```
Makespan: 50000 time units
```
Bottleneck at stations with few machines. Consider:
- Adding machines to bottleneck stations
- Balancing processing times

---

## Programmatic Access

### Reading CSV Files

```python
import pandas as pd

# Read sheet summary
df = pd.read_csv("output/run_folder/sheet_summary.csv")
print(df[df['Utilization (%)'] < 90])  # Low utilization sheets

# Read product summary
products = pd.read_csv("output/run_folder/product_summary.csv")
print(products.sort_values('Completion Time', ascending=False).head())
```

### Generating Custom Reports

```python
from output_generator import OutputGenerator

generator = OutputGenerator(solution, problem, data_file)
generator.create_output_folder()

# Generate only specific outputs
generator.export_sheet_summary_csv()
generator.export_product_summary_csv()

# Skip image generation for faster processing
# generator.generate_all_sheet_images()  # Comment out
```

---

## File Size Estimates

| File | Typical Size | Depends On |
|------|--------------|------------|
| sheet_parts.csv | ~100-500 KB | Number of parts |
| sheet_summary.csv | ~5-20 KB | Number of sheets |
| product_summary.csv | ~5-20 KB | Number of products |
| schedule.csv | ~10-50 KB | Sheets × Stations |
| solution_summary.txt | ~1 KB | Fixed |
| Each sheet image | ~50-200 KB | Parts per sheet |
| Total images | ~5-50 MB | Number of sheets |

---

## Archiving Outputs

Each run creates a timestamped folder, allowing you to:

1. **Compare runs**: Keep multiple optimization attempts
2. **Track changes**: See how different parameters affect results
3. **Archive**: Zip old folders for long-term storage

```bash
# Archive old runs
zip -r archive_$(date +%Y%m).zip output/
```
